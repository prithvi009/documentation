---
title: 'Agency & Service Business Attribution - Track Clients and Revenue'
sidebarTitle: 'Agencies & Services'
description: 'Integrate TrackSource for agencies and service businesses. Track leads, discovery calls, proposals, and client revenue from WordPress, HubSpot, and Calendly.'
icon: 'briefcase'
og:title: 'Agency Marketing Attribution | TrackSource'
og:description: 'Know which marketing drives your best clients. Track the full sales cycle from lead to signed contract.'
---

# Agencies & Service Business Integration Guide

Track the complete B2B sales cycle from initial inquiry through discovery call, proposal, and client acquisition.

## Typical Agency/Service Stack

```
LinkedIn Ad  →  Website  →  Contact Form  →  Discovery Call  →  Proposal  →  Invoice
                (WP)        (HubSpot)        (Calendly)        (Manual)     (Stripe)
```

**Common Technologies**:
- **Website**: WordPress, Webflow, Squarespace
- **CRM/Forms**: HubSpot, Salesforce, GoHighLevel
- **Booking**: Calendly, Cal.com, Acuity
- **Invoicing**: Stripe, QuickBooks, FreshBooks

## Integration Overview

<Steps>
  <Step title="Install SDK on Website">
    Track visitors across your marketing site
  </Step>
  <Step title="Connect Form/CRM">
    Capture leads with attribution data
  </Step>
  <Step title="Connect Calendly">
    Track discovery calls booked
  </Step>
  <Step title="Track Revenue">
    Connect invoicing for client value attribution
  </Step>
</Steps>

---

## Step 1: Website Setup

### WordPress

**Option A: Theme Header**

Add to **header.php** before `</head>`:

```html
<!-- TrackSource Attribution -->
<script src="https://events.tracksource.io/sdk/ts.min.js" data-tenant="YOUR_TENANT_ID"></script>
```

**Option B: Plugin (Recommended)**

Use "Insert Headers and Footers" plugin:
1. Install and activate the plugin
2. Go to **Settings** → **Insert Headers and Footers**
3. Paste the script in **Scripts in Header**:
   ```html
   <script src="https://events.tracksource.io/sdk/ts.min.js" data-tenant="YOUR_TENANT_ID"></script>
   ```
4. Save

### Webflow

1. Go to **Project Settings** → **Custom Code**
2. Paste in **Head Code**:
   ```html
   <script src="https://events.tracksource.io/sdk/ts.min.js" data-tenant="YOUR_TENANT_ID"></script>
   ```
3. Publish your site

### Squarespace

1. Go to **Settings** → **Advanced** → **Code Injection**
2. Paste in **Header**:
   ```html
   <script src="https://events.tracksource.io/sdk/ts.min.js" data-tenant="YOUR_TENANT_ID"></script>
   ```
3. Save

---

## Step 2: Connect Forms/CRM

### HubSpot Forms

**Webhook Setup:**

1. Go to **Settings** → **Marketing** → **Forms**
2. Select your form → **Options**
3. Under "Send form notifications to", add:
   ```
   https://events.tracksource.io/leads/YOUR_TENANT_ID
   ```

**Hidden Field for Attribution:**

1. Go to **Settings** → **Properties** → **Create property**
2. Create: `ts_anonymous_id` (Single-line text)
3. Add to your forms as a hidden field
4. Add this script to your pages:

```html
<script>
  window.addEventListener('message', function(event) {
    if (event.data.type === 'hsFormCallback' && event.data.eventName === 'onFormReady') {
      var attribution = window.tsAttribution || {};
      var tsId = attribution.anonymous_id || '';
      var field = document.querySelector('input[name="ts_anonymous_id"]');
      if (field && tsId) field.value = tsId;
    }
  });
</script>
```

### WordPress Contact Form 7

Add hidden field to your form:

```
[hidden ts_anonymous_id default:get]
```

Add this to your theme:

```php
// functions.php
add_action('wp_footer', 'ts_cf7_hidden_field');
function ts_cf7_hidden_field() {
    ?>
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        var field = document.querySelector('input[name="ts_anonymous_id"]');
        if (field) {
          var attribution = window.tsAttribution || {};
          var tsId = attribution.anonymous_id || '';
          field.value = tsId;
        }
      });
    </script>
    <?php
}

// Send to TrackSource on submission
add_action('wpcf7_mail_sent', 'ts_cf7_webhook');
function ts_cf7_webhook($contact_form) {
    $submission = WPCF7_Submission::get_instance();
    if (!$submission) return;

    $data = $submission->get_posted_data();

    wp_remote_post('https://events.tracksource.io/leads/YOUR_TENANT_ID', array(
        'body' => json_encode(array(
            'email' => $data['your-email'],
            'name' => $data['your-name'],
            'phone' => $data['your-phone'] ?? '',
            'message' => $data['your-message'] ?? '',
            'ts_anonymous_id' => $data['ts_anonymous_id'] ?? ''
        )),
        'headers' => array('Content-Type' => 'application/json')
    ));
}
```

### WordPress Gravity Forms

1. Go to **Forms** → **Settings** → **Webhooks**
2. Add new webhook:
   - Request URL: `https://events.tracksource.io/leads/YOUR_TENANT_ID`
   - Request Method: POST
   - Request Format: JSON
3. Map fields including a hidden field for `ts_anonymous_id`

### GoHighLevel

1. Create a workflow triggered by form submission
2. Add **Webhook** action:
   - URL: `https://events.tracksource.io/leads/YOUR_TENANT_ID`
   - Method: POST
3. Map contact fields

---

## Step 3: Connect Calendly

Track when leads book discovery calls:

1. Go to [calendly.com](https://calendly.com) → **Integrations** → **Webhooks**
2. Create webhook:
   - URL: `https://events.tracksource.io/webhooks/calendly/YOUR_TENANT_ID`
   - Events: `invitee.created`, `invitee.canceled`

### Pass Attribution to Calendly

Add this script to pages with Calendly links:

```html
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Update all Calendly links with UTM parameters
    document.querySelectorAll('a[href*="calendly.com"]').forEach(function(link) {
      var url = new URL(link.href);
      var params = new URLSearchParams(window.location.search);

      // Pass UTMs
      ['utm_source', 'utm_medium', 'utm_campaign'].forEach(function(param) {
        if (params.has(param)) {
          url.searchParams.set(param, params.get(param));
        }
      });

      link.href = url.toString();
    });
  });
</script>
```

### Embedded Calendly Widget

```html
<div class="calendly-inline-widget" data-url="https://calendly.com/your-name/discovery" style="min-width:320px;height:630px;"></div>
<script type="text/javascript" src="https://assets.calendly.com/assets/external/widget.js" async></script>

<script>
  // Pass UTMs to embedded widget
  document.addEventListener('DOMContentLoaded', function() {
    var widget = document.querySelector('.calendly-inline-widget');
    if (widget) {
      var params = new URLSearchParams(window.location.search);
      var url = new URL(widget.dataset.url);

      ['utm_source', 'utm_medium', 'utm_campaign'].forEach(function(param) {
        if (params.has(param)) {
          url.searchParams.set(param, params.get(param));
        }
      });

      widget.dataset.url = url.toString();
    }
  });
</script>
```

---

## Step 4: Track Revenue

### Stripe Invoices

If you use Stripe for invoicing:

1. Go to **Developers** → **Webhooks**
2. Add endpoint:
   - URL: `https://events.tracksource.io/payments/YOUR_TENANT_ID/stripe`
   - Events: `invoice.paid`, `invoice.payment_succeeded`

### Manual Revenue Entry (API)

For offline payments or other invoicing systems, use the API:

```bash
curl -X POST https://events.tracksource.io/v1/events \
  -H "Content-Type: application/json" \
  -H "X-Tenant-ID: YOUR_TENANT_ID" \
  -d '{
    "event_type": "conversion",
    "user_id": "client@company.com",
    "properties": {
      "email": "client@company.com",
      "conversion_value": 5000,
      "currency": "USD",
      "order_id": "INV-2024-001",
      "client_name": "Acme Corp",
      "service": "Website Redesign"
    }
  }'
```

### HubSpot Deal Integration

If you track deals in HubSpot, create a workflow:

1. Trigger: **Deal stage is Closed Won**
2. Action: **Webhook** to TrackSource with deal value

---

## Step 5: Track the Full Pipeline

### Lead Stages

Track lead progression through your pipeline:

```javascript
// When lead becomes qualified
TracksSource.track('lead_qualified', {
  email: 'lead@company.com',
  lead_score: 85,
  qualification_method: 'discovery_call'
});

// When proposal sent
TracksSource.track('proposal_sent', {
  email: 'lead@company.com',
  proposal_value: 15000,
  service: 'Website Development'
});

// When deal closed
TracksSource.track('conversion', {
  email: 'lead@company.com',
  conversion_value: 15000,
  client_name: 'Acme Corp',
  service: 'Website Development',
  contract_length: 3 // months
});
```

---

## Agency Metrics

### What You'll Track

| Stage | Event | Metrics |
|-------|-------|---------|
| Visit | `page_view` | Website visitors by source |
| Lead | `lead` | Form submissions, cost per lead |
| Call Booked | `meeting_booked` | Discovery calls, show rate |
| Qualified | `lead_qualified` | Qualified leads by source |
| Proposal | `proposal_sent` | Proposal rate, avg value |
| Closed | `conversion` | Clients, revenue, CAC |

### Key Performance Indicators

| KPI | Formula | Example |
|-----|---------|---------|
| **Cost per Lead** | Ad Spend / Leads | $2,000 / 40 = $50 |
| **Cost per Client** | Ad Spend / Clients | $2,000 / 4 = $500 |
| **Close Rate** | Clients / Qualified Leads | 4 / 20 = 20% |
| **Client LTV** | Avg Revenue × Retention | $5,000 × 12mo = $60,000 |
| **Lead Quality Score** | Qualified / Total Leads | 20 / 40 = 50% |

### Example Attribution Report

```
Channel        Leads    Qualified    Calls    Clients    Revenue      CPL      CPA
─────────────────────────────────────────────────────────────────────────────────
LinkedIn        25         15          12        4       $60,000     $80     $500
Google Ads      40         20          15        5       $50,000     $50     $400
Referral        15         12          10        6       $90,000      $0       $0
Organic         30         18          14        5       $75,000      $0       $0
─────────────────────────────────────────────────────────────────────────────────
Total          110         65          51       20      $275,000
```

---

## Long Sales Cycle Tracking

B2B sales often take weeks or months. TrackSource handles this:

### Attribution Window

Default is 30 days, but for agencies you may want longer:

- First touch attribution remembers the original source
- The full journey is preserved regardless of time
- Revenue is attributed even months after first visit

### Example Journey

```
Week 1:  LinkedIn Ad Click → Reads blog post
Week 2:  Returns via Google → Downloads whitepaper (becomes lead)
Week 4:  Email nurture → Books discovery call
Week 6:  Direct visit → Views pricing
Week 8:  Signs contract → $15,000 deal

Attribution (First Touch): LinkedIn Ad gets credit
Attribution (Last Touch): Direct visit gets credit
Attribution (Linear): All touchpoints share credit
```

---

## Complete WordPress + HubSpot Example

```php
<?php
// functions.php - Complete TrackSource Integration

// 1. Add TrackSource script
add_action('wp_head', 'ts_tracking_script');
function ts_tracking_script() {
    ?>
    <script src="https://events.tracksource.io/sdk/ts.min.js" data-tenant="YOUR_TENANT_ID"></script>
    <?php
}

// 2. Populate hidden fields
add_action('wp_footer', 'ts_populate_hidden_fields');
function ts_populate_hidden_fields() {
    ?>
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        // For HubSpot forms
        window.addEventListener('message', function(event) {
          if (event.data.type === 'hsFormCallback' && event.data.eventName === 'onFormReady') {
            var attribution = window.tsAttribution || {};
            var tsId = attribution.anonymous_id || '';
            var field = document.querySelector('input[name="ts_anonymous_id"]');
            if (field && tsId) field.value = tsId;
          }
        });

        // For native WP forms
        var field = document.querySelector('input[name="ts_anonymous_id"]');
        if (field) {
          var attribution = window.tsAttribution || {};
          var tsId = attribution.anonymous_id || '';
          field.value = tsId;
        }

        // Update Calendly links
        document.querySelectorAll('a[href*="calendly.com"]').forEach(function(link) {
          var url = new URL(link.href);
          var params = new URLSearchParams(window.location.search);
          ['utm_source', 'utm_medium', 'utm_campaign'].forEach(function(p) {
            if (params.has(p)) url.searchParams.set(p, params.get(p));
          });
          link.href = url.toString();
        });
      });
    </script>
    <?php
}
```

---

## Troubleshooting

<AccordionGroup>
  <Accordion title="Leads not attributed to source">
    1. Verify TrackSource script loads on all pages
    2. Check that hidden field `ts_anonymous_id` is being populated
    3. Ensure form webhook is configured correctly
    4. Test by filling out form and checking dashboard
  </Accordion>

  <Accordion title="Calendly calls not tracking">
    1. Verify webhook in Calendly settings
    2. Check webhook delivery logs in Calendly
    3. Ensure UTM parameters are in Calendly URL
  </Accordion>

  <Accordion title="Revenue not matching actual">
    1. For manual entry, ensure API calls are working
    2. Check Stripe webhook is configured for invoices
    3. Verify currency is correct
  </Accordion>

  <Accordion title="Long gap between lead and sale">
    This is normal for B2B! TrackSource preserves attribution:
    1. Check customer profile shows full journey
    2. Use first-touch attribution for lead source credit
    3. Revenue will be attributed to original source
  </Accordion>
</AccordionGroup>

## Next Steps

<CardGroup cols={2}>
  <Card title="HubSpot Integration" icon="hubspot" href="/webhooks/hubspot">
    Detailed HubSpot setup guide
  </Card>
  <Card title="Calendly Integration" icon="calendar" href="/webhooks/calendly">
    Connect Calendly for call tracking
  </Card>
</CardGroup>
